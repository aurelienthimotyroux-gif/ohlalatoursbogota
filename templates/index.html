<!DOCTYPE html>
<html lang="{{ get_locale() }}">
<head>
  <meta charset="UTF-8" />
  <title>{{ _("Accueil") }} — Oh La La Tours Bogotá</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Meta description (SEO) -->
  <meta name="description" content="{{ _('Visites guidées à Bogotá avec Alejandra, guide locale. Tours privés en français, anglais et espagnol : Candelaria, Monserrate, Zipaquirá, café (Hacienda Coloma), transport et transferts aéroport.') }}">

  <!-- Keywords (facultatif) -->
  <meta name="keywords" content="visite guidée Bogotá, guide francophone Bogotá, excursion Bogotá, tours privés Bogotá, visiter la Candelaria Bogotá, excursion Zipaquirá depuis Bogotá, randonnée Monserrate Bogotá, café, Bogota, Colombie, Monserrate, Zipaquira, Coloma, Hacienda Coloma, guide, tejo, Chapinero, hôtel, hostel, Alejandra, gastronomie, pesos, taxi, transport, van, aéroport, français, anglais, espagnol, Aguila, Club Colombia, histoire, tours exceptionnels">

  <!-- CMP / consentmanager -->
  <script type="text/javascript" data-cmp-ab="1"
          src="https://cdn.consentmanager.net/delivery/autoblocking/62cc8437f29ac.js"
          data-cmp-host="b.delivery.consentmanager.net"
          data-cmp-cdn="cdn.consentmanager.net"
          data-cmp-codesrc="16"></script>

  <!-- Google Consent Mode -->
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('consent', 'default', {
      ad_storage: 'denied',
      analytics_storage: 'denied',
      ad_user_data: 'denied',
      ad_personalization: 'denied',
      wait_for_update: 500
    });
  </script>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-92M6CENDXH"></script>
  <script>
    gtag('js', new Date());
    gtag('config', 'G-92M6CENDXH', { anonymize_ip: true });
  </script>

  <!-- Canonical + hreflang -->
  <link rel="canonical" href="https://www.ohlalatoursbogota.com{{ request.path }}{% if get_locale()!='fr' %}?lang={{ get_locale() }}{% endif %}">
  <link rel="alternate" href="{{ url_for('index', lang='fr', _external=True) }}" hreflang="fr">
  <link rel="alternate" href="{{ url_for('index', lang='en', _external=True) }}" hreflang="en">
  <link rel="alternate" href="{{ url_for('index', lang='es', _external=True) }}" hreflang="es">
  <link rel="alternate" href="{{ url_for('index', lang='fr', _external=True) }}" hreflang="x-default">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://www.ohlalatoursbogota.com{{ request.path }}{% if get_locale()!='fr' %}?lang={{ get_locale() }}{% endif %}">
  <meta property="og:site_name" content="Oh La La Tours Bogotá">
  <meta property="og:title" content="{{ _('Visites guidées à Bogotá – Guide francophone & tours privés') }}">
  <meta property="og:description" content="{{ _('Découvrez Bogotá : Candelaria, Monserrate, Zipaquirá, café à Hacienda Coloma. Visites en français, anglais et espagnol. Transferts aéroport, chauffeur/van privé.') }}">
  <meta property="og:image" content="{{ url_for('static', filename='images/accueil.jpg', _external=True) }}">
  {% if get_locale() == 'fr' %}
  <meta property="og:locale" content="fr_FR">
  {% elif get_locale() == 'en' %}
  <meta property="og:locale" content="en_US">
  {% else %}
  <meta property="og:locale" content="es_CO">
  {% endif %}

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="{{ _('Visites guidées à Bogotá – Guide francophone & tours privés') }}">
  <meta name="twitter:description" content="{{ _('Découvrez Bogotá : Candelaria, Monserrate, Zipaquirá, café à Hacienda Coloma. Visites en français, anglais et espagnol. Transferts aéroport, chauffeur/van privé.') }}">
  <meta name="twitter:image" content="{{ url_for('static', filename='images/accueil.jpg', _external=True) }}">

  <!-- Perf & UI mobile -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <meta name="theme-color" content="#0e7490" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#0b4654" media="(prefers-color-scheme: dark)">

  <!-- CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='mobile-pack.css', v=1) }}" media="(max-width: 767px)">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

  <!-- Favicons -->
  <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='img/favicon/apple-touch-icon.png') }}">
  <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='img/favicon/favicon-32x32.png') }}">
  <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='img/favicon/favicon-16x16.png') }}">
  <link rel="manifest" href="{{ url_for('static', filename='img/favicon/site.webmanifest') }}">
  <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='img/favicon/favicon.ico') }}">
  <link rel="icon" href="/favicon.ico" sizes="any">
  <meta name="theme-color" content="#0b4654">
  <meta name="google-site-verification" content="4z28-XXEkdcB_VOcaGoy1bhgA-zj7xr6wSf76ZwZ4tQ" />

  <!-- Styles spécifiques (header, logos, etc.) -->
  <style>
    .site-header{
      position:fixed; top:0; left:0; right:0; z-index:70;
      display:flex; align-items:center; justify-content:space-between;
      padding:10px 16px; gap:16px;
      background:transparent; transition:background .25s ease, box-shadow .25s ease;
    }
    .logo-container{display:flex; align-items:center; gap:10px}
    .logo{height:44px; width:auto; display:block}
    @media (max-width:640px){ .logo{height:32px} }
    .main-nav{display:flex; align-items:center; gap:18px; font-weight:600}
    .main-nav a{text-decoration:none}
    .site-title{font-size:20px; font-weight:600; color:#0f172a}

    /* par défaut: logo clair visible, foncé caché (hero photo) */
    .logo--dark{display:none}

    /* Header sur la hero : liens/titre en blanc */
    .header-on-hero .site-title{ color:#fff; text-shadow:0 1px 2px rgba(0,0,0,.35); }
    .header-on-hero .main-nav a{ color:#fff; text-shadow:0 1px 2px rgba(0,0,0,.35); }

    /* Au scroll / fond clair */
    .site-header.scrolled{
      background: rgba(255,255,255,.86);
      backdrop-filter: saturate(180%) blur(8px);
      box-shadow: 0 2px 10px rgba(0,0,0,.08);
    }
    .site-header.scrolled .logo--light{display:none}
    .site-header.scrolled .logo--dark{display:block}
    .site-header.scrolled .main-nav a{color:#0f172a}
    .site-header.scrolled .site-title{ color:#0f172a; }

    /* Avis & divers (inchangés) */
    .testimonials { background:#fff; padding:40px 20px; margin-top:40px; }
    .testimonials .container { max-width:1000px; margin:0 auto; }
    .testimonials h2 { text-align:center; margin-bottom:22px; font-size:28px; }
    .testimonials-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:18px; }
    @media (max-width:1024px){ .testimonials-grid{ grid-template-columns:repeat(2,1fr);} }
    @media (max-width:640px){ .testimonials-grid{ grid-template-columns:1fr;} }
    .testimonial-card { background:#fafafa; border:1px solid #eee; border-radius:12px; padding:16px; box-shadow:0 4px 14px rgba(0,0,0,.06); }
    .t-head { display:grid; grid-template-columns:auto 1fr; gap:6px 10px; align-items:center; margin-bottom:10px; }
    .t-name { font-weight:600; }
    .t-meta { color:#666; font-size:14px; }
    .t-stars { display:inline-flex; gap:4px; align-items:center; margin-bottom:8px; }
    .t-stars svg { width:18px; height:18px; }
    .testimonial-card .t-text{ font-size:15px; color:#333; line-height:1.5; white-space:pre-wrap; word-break:break-word; }
    .testimonial-card .t-text.clamp{ display:-webkit-box; -webkit-box-orient:vertical; -webkit-line-clamp:4; overflow:hidden; }
    .testimonial-card.expanded .t-text{ -webkit-line-clamp:unset; display:block; overflow:visible; }
    .testimonial-card .t-toggle{ margin-top:8px; background:none; border:0; color:#007bff; font:inherit; cursor:pointer; padding:0; }
    .testimonial-card .t-toggle:hover{ text-decoration:underline; }
    .comment-section-title { text-align:center; font-size:2rem; margin-bottom:20px; }
    .hero .nav-hero a { text-decoration:none; }
    .hero .nav-hero a:focus { outline:2px dashed #333; outline-offset:3px; }
    .sr-only { position:absolute!important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,1px,1px); white-space:nowrap; border:0; }
    .flash-wrap { max-width:1000px; margin:16px auto; padding:0 20px; }
    .flash { margin:8px 0; padding:10px; border-radius:8px; }
    .flash-success{ background:#eefbf0; border:1px solid #b7ebc6; color:#1b5e20; }
    .flash-error{ background:#fdeaea; border:1px solid #f5c2c2; color:#8a1f1f; }
    @media (min-width: 768px){ .sticky-cta { display: none; } }
  </style>

  <!-- ✅ AJOUT CSS: Burger + drapeaux mobile (rien d’autre modifié) -->
  <style>
    /* Cacher le titre en mobile */
    @media (max-width: 640px){ .site-title{ display:none; } }

    /* Bouton burger */
    .burger{display:none;background:none;border:0;width:38px;height:38px;
            align-items:center;justify-content:center;border-radius:8px;color:#fff}
    .burger svg{width:26px;height:26px}
    .site-header.scrolled .burger{color:#0f172a}
    @media (max-width:900px){
      .main-nav{display:none !important}
      .burger{display:inline-flex !important}
    }

    /* Drapeaux compacts visibles en mobile dans la barre */
    .lang-compact{display:none; gap:8px; font-size:20px; line-height:1}
    .lang-compact a{padding:2px 4px; border-radius:6px; text-decoration:none}
    .header-on-hero .lang-compact a{color:#fff; text-shadow:0 1px 2px rgba(0,0,0,.35)}
    .site-header.scrolled .lang-compact a{color:#0f172a; text-shadow:none}
    @media (max-width:900px){ .lang-compact{display:flex} }

    /* Panneau mobile + overlay */
    .mobile-menu{position:fixed;top:0;right:0;bottom:0;width:min(86vw,360px);
      background:#fff;box-shadow:-10px 0 30px rgba(0,0,0,.15);
      transform:translateX(100%);transition:transform .25s ease;z-index:120}
    .mobile-menu.open{transform:translateX(0)}
    .mobile-menu header{display:flex;align-items:center;justify-content:space-between;
      padding:12px 16px;border-bottom:1px solid #eee}
    .mobile-menu header button{background:none;border:0;width:36px;height:36px}
    .mobile-menu nav a{display:block;padding:14px 16px;border-bottom:1px solid #f1f1f1;
      color:#0f172a;text-decoration:none}
    .mobile-menu .langs{display:flex;gap:10px;padding:14px 16px;font-size:22px}

    .mobile-overlay{position:fixed;inset:0;background:rgba(0,0,0,.35);
      backdrop-filter:blur(2px);opacity:0;pointer-events:none;transition:opacity .2s;
      z-index:110}
    .mobile-overlay.show{opacity:1;pointer-events:auto}
  </style>
</head>

<body>

<!-- Sprite d'icônes SVG (étoiles) -->
<svg xmlns="http://www.w3.org/2000/svg" style="display:none;">
  <symbol id="icon-star-full" viewBox="0 0 24 24" aria-hidden="true">
    <path fill="#ffb400" d="M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.62L12 2 9.19 8.62 2 9.24l5.46 4.73L5.82 21z"/>
  </symbol>
  <symbol id="icon-star-half" viewBox="0 0 24 24" aria-hidden="true">
    <path fill="#ffb400" d="M12 17.27V2L9.19 8.62 2 9.24l5.46 4.73L5.82 21z"/>
    <path fill="none" stroke="#ffb400" stroke-width="1.5" d="M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.62L12 2 9.19 8.62 2 9.24l5.46 4.73L5.82 21z"/>
  </symbol>
  <symbol id="icon-star-empty" viewBox="0 0 24 24" aria-hidden="true">
    <path fill="none" stroke="#ffb400" stroke-width="1.5" d="M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.62L12 2 9.19 8.62 2 9.24l5.46 4.73L5.82 21z"/>
  </symbol>
</svg>

<!-- HEADER (logos light/dark + nav) -->
<header class="site-header header-on-hero">
  <div class="logo-container">
    <!-- Logo clair (sur hero/photo) -->
    <img src="{{ url_for('static', filename='img/logo-light.png') }}" alt="Oh La La Tours Bogotá" class="logo logo--light">
    <!-- Logo foncé (après scroll, fond clair) -->
    <img src="{{ url_for('static', filename='img/logo-dark.png') }}" alt="Oh La La Tours Bogotá" class="logo logo--dark">
    <span class="site-title">Oh La La Tours Bogotá</span>
  </div>

  <!-- Navigation -->
  <nav class="main-nav" aria-label="{{ _('Navigation principale') }}">
    <a href="{{ url_for('index', lang=get_locale()) }}">{{ _("Accueil") }}</a>
    <a href="{{ url_for('tours', lang=get_locale()) }}">{{ _("Nos tours") }}</a>
    <a href="{{ url_for('transport', lang=get_locale()) }}">{{ _("Service de Transport") }}</a>
    <a href="{{ url_for('reservation', lang=get_locale()) }}">{{ _("Réservation") }}</a>
    <div class="lang-switcher" aria-label="{{ _('Changer de langue') }}">
      <a href="{{ lang_url('fr') }}" lang="fr" aria-label="Français">🇫🇷<span class="sr-only">Français</span></a>
      <a href="{{ lang_url('en') }}" lang="en" aria-label="English">🇺🇸<span class="sr-only">English</span></a>
      <a href="{{ lang_url('es') }}" lang="es" aria-label="Español">🇪🇸<span class="sr-only">Español</span></a>
    </div>
  </nav>

  <div class="mobile-menu">
  <a href="{{ url_for('index', lang=get_locale()) }}">{{ _("Accueil") }}</a>
  <a href="{{ url_for('tours', lang=get_locale()) }}">{{ _("Nos tours") }}</a>
  <a href="{{ url_for('transport', lang=get_locale()) }}">{{ _("Service de Transport") }}</a>
  <a href="{{ url_for('reservation', lang=get_locale()) }}">{{ _("Réservation") }}</a>

  <!-- ✅ Langues uniquement ici -->
  <div class="lang-switcher">
    <a href="{{ lang_url('fr') }}">🇫🇷</a>
    <a href="{{ lang_url('en') }}">🇺🇸</a>
    <a href="{{ lang_url('es') }}">🇪🇸</a>
  </div>
</div>


 <!-- ✅ bouton burger corrigé -->
<button class="burger" aria-label="Ouvrir le menu" aria-controls="mobileMenu" aria-expanded="false">
  <svg viewBox="0 0 24 24" aria-hidden="true" width="28" height="28">
    <path d="M3 6h18M3 12h18M3 18h18"
          stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"/>
  </svg>
</button>
</header>

<!-- ✅ overlay + panneau mobile -->
<div id="mobileOverlay" class="mobile-overlay"></div>

<aside id="mobileMenu" class="mobile-menu" role="dialog" aria-modal="true" aria-label="Menu">
  <header>
    <strong>Oh La La Tours Bogotá</strong>
    <button id="mobileClose" aria-label="Fermer">
      <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor" aria-hidden="true">
        <path d="M6 6l12 12M18 6L6 18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"/>
      </svg>
    </button>
  </header>

  <nav>
    <a href="{{ url_for('index',     lang=get_locale()) }}">{{ _("Accueil") }}</a>
    <a href="{{ url_for('tours',     lang=get_locale()) }}">{{ _("Nos tours") }}</a>
    <a href="{{ url_for('transport', lang=get_locale()) }}">{{ _("Service de Transport") }}</a>
    <a href="{{ url_for('reservation', lang=get_locale()) }}">{{ _("Réservation") }}</a>
  </nav>

  <div class="langs" aria-label="{{ _('Changer de langue') }}">
    <a href="{{ lang_url('fr') }}" lang="fr" aria-label="Français">🇫🇷</a>
    <a href="{{ lang_url('en') }}" lang="en" aria-label="English">🇺🇸</a>
    <a href="{{ lang_url('es') }}" lang="es" aria-label="Español">🇪🇸</a>
  </div>
</aside>

<!-- HERO (image de couverture) -->
<header class="hero"
        role="img"
        aria-label="Bogota Monserrate Candelaria street art visites guidées privées guide francophone café colombien cathédrale de sel Zipaquira Hacienda Coloma transport privé transfert aéroport safe friendly professional travel Colombia colombie chorrera gastronomie"
        style="background-image: url('{{ url_for('static', filename='images/accueil.jpg') }}');">

  <span class="sr-only">
    {{ _('Photo de couverture Bogotá Monserrate Candelaria street art Cathédrale de sel Zipaquirá Hacienda Coloma visites guidées privées guide francophone transport privé transfert aéroport') }}
    Cover photo Bogota Monserrate Candelaria street art Salt Cathedral Zipaquira coffee farm Hacienda Coloma private tours French speaking guide private transport airport transfer
    Foto de portada Bogotá Monserrate Candelaria arte urbano Catedral de Sal Zipaquirá finca cafetera Hacienda Coloma tours privados guía francófona transporte privado traslado aeropuerto
  </span>

  <h1 class="hero-title">{{ _("Bienvenue à Bogotá !") }}</h1>
</header>

<!-- Messages flash -->
{% with msgs = get_flashed_messages(with_categories=true) %}
  {% if msgs %}
    <div class="flash-wrap" role="status" aria-live="polite">
      {% for cat, msg in msgs %}
        <div class="flash flash-{{ cat }}">{{ msg }}</div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

<main style="max-width: 1000px; margin: 30px auto; padding: 0 20px;">
  <section>
    <p>{{ _("Je suis Alejandra, guide locale passionnée, et je vous invite à découvrir une Bogotá authentique, vibrante et pleine de vie.") }}</p>
    <p>{{ _("À travers mes visites en petits groupes, nous explorerons son histoire, sa culture et ses saveurs : balades dans les quartiers historiques, expériences culinaires, escapades en pleine nature et excursions uniques aux alentours, comme la célèbre Cathédrale de sel de Zipaquirá.") }}</p>
    <p>{{ _("Plus qu’une simple visite, je vous propose une immersion vivante et chaleureuse, une expérience à ressentir et à emporter avec vous.") }}</p>
    <p>{{ _("Je propose des visites guidées à Bogotá, des tours privés vers la Candelaria, Monserrate et Zipaquirá, ainsi qu’un service de transport (taxi/van) et transferts aéroport.") }}</p>
  </section>

  <section style="margin-top: 20px;">
    <a class="btn" href="{{ url_for('tours', lang=get_locale()) }}" role="button" style="display:inline-block;padding:10px 16px;border-radius:8px;background:#222;color:#fff;text-decoration:none;">{{ _("Voir les types de visites") }}</a>
    <a class="btn" href="{{ url_for('reservation', lang=get_locale()) }}" role="button" style="display:inline-block;padding:10px 16px;border-radius:8px;background:#007bff;color:#fff;text-decoration:none;margin-left:10px;">{{ _("Réserver maintenant") }}</a>
  </section>
</main>

<!-- SECTION CONTACT -->
<section style="background: #f9f9f9; padding: 40px 20px; margin-top: 40px;">
  <div style="max-width: 1000px; margin: auto; display: flex; flex-wrap: wrap; align-items: flex-start; gap: 20px;">
    <div style="flex: 1; min-width: 250px; min-height: 300px;">
      <img 
        src="{{ url_for('static', filename='images/alejandra.jpg') }}"
        alt="{{ _('Alejandra, votre guide à Bogotá') }} guide francophone Bogotá guide locale visites privées La Candelaria Monserrate Zipaquirá Hacienda Coloma café colombien transport privé transfert aéroport tejo gastronomie culture amicale professionnelle bienvenue a bogota que faire à bogota
             French speaking tour guide in Bogota local guide private tours historic center La Candelaria Monserrate Salt Cathedral Zipaquira coffee farm Hacienda Coloma private transport airport transfer friendly professional safe
             guía francófona en Bogotá guía local tours privados centro histórico La Candelaria Monserrate Catedral de Sal Zipaquirá finca cafetera Hacienda Coloma transporte privado traslado aeropuerto amable profesional segura"
        loading="lazy" decoding="async" width="800" height="600"
        style="display: block; width: 100%; height: 100%; object-fit: cover; border-radius: 10px; background: #ddd;">
    </div>
    <div style="flex: 1; min-width: 250px;">
      <h2>{{ _("Contact") }}</h2>
      <p><strong>{{ _("Email") }} :</strong> <a href="mailto:ohlalatoursbogota@gmail.com">ohlalatoursbogota@gmail.com</a></p>
      <p><strong>{{ _("WhatsApp") }} :</strong> <a href="https://wa.me/573505384537" target="_blank" rel="noopener">+57 350 538 4537</a></p>
      <p>{{ _("N’hésitez pas à me contacter pour toute question ou réservation.") }}</p>
    </div>
  </div>
</section>

<!-- Formulaire Laisser un commentaire -->
<section style="max-width: 1000px; margin: 30px auto; padding: 0 20px;">
  <h2 class="comment-section-title">{{ _("À votre tour de laisser un joli commentaire") }}</h2>
  <form method="POST" action="{{ url_for('submit_comment', lang=get_locale()) }}" style="background:#fafafa; border-radius:14px; padding:20px; box-shadow:0 6px 18px rgba(0,0,0,0.08); display:grid; gap:12px; max-width:600px;">
    <label>{{ _("Votre nom et pays") }}<br><input name="name" required aria-required="true"></label>
    <label>{{ _("Votre commentaire") }}<br><textarea name="message" rows="4" required aria-required="true"></textarea></label>
    <label>{{ _("Votre note") }}<br>
      <select name="rating" required aria-required="true">
        <option value="1">★</option>
        <option value="2">★★</option>
        <option value="3">★★★</option>
        <option value="4">★★★★</option>
        <option value="5" selected>★★★★★</option>
      </select>
    </label>
    <button type="submit">{{ _("Envoyer") }}</button>
  </form>
</section>

<!-- Section Commentaires -->
<section class="testimonials">
  <div class="container">
    <h2>{{ _("Avis des voyageurs") }}</h2>

    <!-- Grille unique : on met BDD + fallback dedans, puis JS trie par date -->
    <div class="testimonials-grid" id="all-testimonials">

      {# ---- 1) Commentaires BDD (inchangés) ---- #}
      {% for comment in comments or [] %}
        {% set is_long = (comment.message|length > 200) %}
        <div class="testimonial-card" data-name="{{ comment.name }}" data-country="{{ comment.country or '' }}" data-ts="">
          <div class="t-head">
            <div class="t-name">
              {{ comment.name }}{% if comment.country %} · {{ comment.country }}{% endif %}
            </div>
            <div class="t-meta">{{ comment.date_str }}</div>
          </div>

          <div class="t-stars" aria-label="{{ comment.rating }} / 5">
            {% for i in range(1, 6) %}
              {% if comment.rating >= i %}
                <svg><use href="#icon-star-full"></use></svg>
              {% elif comment.rating >= i - 0.5 %}
                <svg><use href="#icon-star-half"></use></svg>
              {% else %}
                <svg><use href="#icon-star-empty"></use></svg>
              {% endif %}
            {% endfor %}
            <span class="sr-only">{{ comment.rating }} / 5</span>
          </div>

          <p class="t-text{{ ' clamp' if is_long else '' }}"
             id="comment-{{ loop.index }}"
             data-full="{{ comment.message|e }}">
            {{ (comment.message[:200] ~ '...') if is_long else comment.message }}
          </p>
          <button class="t-toggle"
                  onclick="toggleText('{{ loop.index }}')"
                  style="{{ '' if is_long else 'display:none;' }}">
            {{ _("Lire plus") }}
          </button>
        </div>
      {% endfor %}

      {# ---- 2) Fallback : 13 avis fournis (avec date ISO pour tri) ---- #}
      {% set fallback_comments = [
  {"name":"Francis","country":"Canada","date_str":"12 mai 2025","date_iso":"2025-05-12","rating":5,"lang":"fr","message":"L’expérience est super. Alejandra prend son temps pour nous expliquer et répondre à nos questions."},

  {"name":"Katy","country":"Mexique","date_str":"21 mars 2023","date_iso":"2023-03-21","rating":5,"lang":"es","message":"Recomendado. La comunicación con Alejandra fue excelente antes y durante; todo lo descrito se cumplió y siempre estuvo atenta a nuestras necesidades. Probablemente es un lugar que debes visitar si vienes a Bogotá: vistas preciosas y una catedral de sal impresionante."},

  {"name":"Liliana","country":"États-Unis","date_str":"4 mars 2023","date_iso":"2023-03-04","rating":4.5,"lang":"en","message":"Amazing experience! Alejandra and her father (Omar) took care of my husband’s special needs, and everything was handled 100%. The Salt Cathedral and the traditional food at Brasas del Llano made it a 5-star cultural experience."},

  {"name":"Marvin","country":"Mexique","date_str":"15 septembre 2022","date_iso":"2022-09-15","rating":5,"lang":"es","message":"Alejandra y su padre son extraordinarios y nos brindaron un día hermoso en Zipaquirá. Nos vamos con recuerdos excelentes. ¡Gracias!"},

  {"name":"Oscar","country":"Costa Rica","date_str":"8 janvier 2023","date_iso":"2023-01-08","rating":4.5,"lang":"es","message":"Muchas gracias por su amabilidad y disponibilidad. Súper recomendado."},

  {"name":"Sam","country":"États-Unis","date_str":"14 août 2022","date_iso":"2022-08-14","rating":5,"lang":"en","message":"Alejandra and her father Omar were perfect hosts, very attentive to the way I wanted to enjoy the tour."},

  {"name":"Kristina","country":"Mexique","date_str":"27 août 2022","date_iso":"2022-08-27","rating":5,"lang":"es","message":"Recomendamos esta experiencia. La pasamos excelente. Alejandra y su padre son educados y muy amables."},

  {"name":"Jorge","country":"Mexique","date_str":"11 août 2022","date_iso":"2022-08-11","rating":5,"lang":"es","message":"Altamente recomendado. Alejandra y su padre fueron muy amables y atentos con nosotros en todo momento."},

  {"name":"Fabiola","country":"Mexique","date_str":"11 août 2022","date_iso":"2022-08-11","rating":5,"lang":"es","message":"De principio a fin, una experiencia muy agradable. Alejandra y su papá Omar fueron muy atentos y gentiles."},

  {"name":"Luna","country":"Costa Rica","date_str":"25 juillet 2019","date_iso":"2019-07-25","rating":5,"lang":"es","message":"Viaje bien planificado. Puntuales para el pickup en el hotel. Durante el trayecto, Alejandra y Omar fueron muy amables y pacientes."},

  {"name":"Yuliana","country":"Costa Rica","date_str":"18 juillet 2019","date_iso":"2019-07-18","rating":5,"lang":"es","message":"Ale y Omar (su papá) son súper simpáticos y se involucran mucho para que te sientas como en casa."},

  {"name":"Ann","country":"États-Unis","date_str":"22 février 2020","date_iso":"2020-02-22","rating":5,"lang":"en","message":"Friendly, responsive to our questions, and they showed us fascinating places we would never have found on our own."},

  {"name":"Nancy","country":"Mexique","date_str":"30 juillet 2019","date_iso":"2019-07-30","rating":5,"lang":"es","message":"Una de las mejores experiencias que no te puedes perder. Hospitalidad de primera, recorrido agradable y una visita impresionante a la catedral de sal."}
] %}

      {% set db_pairs = namespace(seen={}) %}
      {% for c in comments or [] %}
        {% set kp = (c.name ~ '|' ~ (c.country or '')) %}
        {% set _ = db_pairs.seen.update({kp: 1}) %}
      {% endfor %}

      {% for fb in fallback_comments %}
        {% set kp = fb.name ~ '|' ~ fb.country %}
        {% if not (kp in db_pairs.seen) %}
          {% set is_long = (fb.message|length > 200) %}
          <div class="testimonial-card"
               data-name="{{ fb.name }}" data-country="{{ fb.country }}" data-ts="{{ fb.date_iso }}">
            <div class="t-head">
              <div class="t-name">{{ fb.name }} · {{ fb.country }}</div>
              <div class="t-meta">{{ fb.date_str }}</div>
            </div>

            <div class="t-stars" aria-label="{{ fb.rating }} / 5">
              {% for i in range(1, 6) %}
                {% if fb.rating >= i %}
                  <svg><use href="#icon-star-full"></use></svg>
                {% elif fb.rating >= i - 0.5 %}
                  <svg><use href="#icon-star-half"></use></svg>
                {% else %}
                  <svg><use href="#icon-star-empty"></use></svg>
                {% endif %}
              {% endfor %}
              <span class="sr-only">{{ fb.rating }} / 5</span>
            </div>

            <p class="t-text{{ ' clamp' if is_long else '' }}"
               id="fallback-{{ loop.index }}"
               data-full="{{ fb.message|e }}">
              {{ (fb.message[:200] ~ '...') if is_long else fb.message }}
            </p>
            <button class="t-toggle"
                    onclick="toggleText('fallback-{{ loop.index }}')"
                    style="{{ '' if is_long else 'display:none;' }}">
              {{ _("Lire plus") }}
            </button>
          </div>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</section>

<!-- Sticky bar mobile -->
<div class="sticky-cta">
  <div class="container row">
    <a class="btn btn-outline"
       href="https://wa.me/573505384537?text={{ _('Bonjour Alejandra ! Je suis intéressé par une visite 🤗') | urlencode }}"
       target="_blank" rel="noopener">WhatsApp</a>
    <a class="btn" href="{{ url_for('reservation', lang=get_locale()) }}">{{ _("Réserver") }}</a>
  </div>
</div>

<!-- JS Lire plus / Lire moins -->
<script>
  function toggleText(index) {
    var id = (index && index.toString().startsWith('fallback-')) ? index : "comment-" + index;
    var textElement = document.getElementById(id);
    if (!textElement) return;
    var card = textElement.closest(".testimonial-card");
    var full = textElement.dataset.full || "";
    if (!textElement.dataset.preview) { textElement.dataset.preview = textElement.textContent; }
    var preview = textElement.dataset.preview;
    var toggleButton = textElement.nextElementSibling;
    var isExpanded = card.classList.contains("expanded");
    if (isExpanded) {
      textElement.textContent = preview;
      card.classList.remove("expanded");
      if (toggleButton) toggleButton.textContent = "{{ _('Lire plus') }}";
    } else {
      textElement.textContent = full;
      card.classList.add("expanded");
      if (toggleButton) toggleButton.textContent = "{{ _('Lire moins') }}";
    }
  }
</script>

<!-- Données structurées -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "TouristInformationCenter",
  "name": "Oh La La Tours Bogotá",
  "url": "https://www.ohlalatoursbogota.com/",
  "image": "{{ url_for('static', filename='images/accueil.jpg', _external=True) }}",
  "areaServed": "Bogotá, Colombia",
  "address": { "@type": "PostalAddress", "addressLocality": "Bogotá", "addressCountry": "CO" },
  "availableLanguage": ["French","Spanish","English"],
  "email": "alejandramontana25.18@gmail.com",
  "telephone": "+57-350-538-4537",
  "sameAs": []
}
</script>

<!-- Script : toggle du header au scroll -->
<script>
  (function(){
    const header = document.querySelector('.site-header');
    if(!header) return;
    function onScroll(){ header.classList.toggle('scrolled', window.scrollY > 60); }
    onScroll();
    window.addEventListener('scroll', onScroll, {passive:true});
  })();
</script>

<!-- ✅ Menu mobile (ouvrir/fermer) -->
<script>
  (function(){
    const burger  = document.querySelector('.burger');
    const menu    = document.getElementById('mobileMenu');
    const closeBt = document.getElementById('mobileClose');
    const overlay = document.getElementById('mobileOverlay');
    if(!burger || !menu || !overlay) return;

    const open = () => {
      menu.classList.add('open');
      overlay.classList.add('show');
      burger.setAttribute('aria-expanded','true');
      document.body.style.overflow='hidden';
    };
    const close = () => {
      menu.classList.remove('open');
      overlay.classList.remove('show');
      burger.setAttribute('aria-expanded','false');
      document.body.style.overflow='';
    };

    burger.addEventListener('click', open, {passive:true});
    if (closeBt) closeBt.addEventListener('click', close, {passive:true});
    overlay.addEventListener('click', close, {passive:true});
    window.addEventListener('keydown', (e)=>{ if(e.key==='Escape') close(); });
  })();
</script>

<!-- ✅ Tri par date (FR/EN/ES) pour afficher du plus récent au plus ancien -->
<script>
  (function(){
    const grid = document.getElementById('all-testimonials');
    if(!grid) return;

    const monthMap = {
      'janvier':1,'février':2,'fevrier':2,'mars':3,'avril':4,'mai':5,'juin':6,'juillet':7,'août':8,'aout':8,'septembre':9,'octobre':10,'novembre':11,'décembre':12,'decembre':12,
      'january':1,'february':2,'march':3,'april':4,'may':5,'june':6,'july':7,'august':8,'september':9,'october':10,'november':11,'december':12,
      'enero':1,'febrero':2,'marzo':3,'abril':4,'mayo':5,'junio':6,'julio':7,'agosto':8,'septiembre':9,'octubre':10,'noviembre':11,'diciembre':12
    };

    function parseTS(card){
      // priorité au data-ts ISO si présent
      const iso = card.getAttribute('data-ts');
      if (iso && /^\d{4}-\d{2}-\d{2}$/.test(iso)) return iso.replace(/-/g,'')*1;

      // sinon on tente de parser le texte de .t-meta
      const meta = card.querySelector('.t-meta');
      if(!meta) return 0;
      const s = meta.textContent.trim().toLowerCase();

      // formats possibles: "12 mai 2025" / "25 julio 2019" / "Feb 22, 2020" (rare)
      const m = s.match(/(\d{1,2})\s+([a-záéíóúäëïöüâêîôûàèìòùç]+)\s+(\d{4})/i);
      if(m){
        const d = ('0'+m[1]).slice(-2);
        const mm = monthMap[(m[2]||'').normalize('NFD').replace(/[\u0300-\u036f]/g,'')] || 1;
        const month = ('0'+mm).slice(-2);
        const y = m[3];
        return (y+month+d)*1;
      }

      // fallback neutre
      return 0;
    }

    const cards = Array.from(grid.children);
    cards.forEach(c => c.dataset._ts = parseTS(c));

    cards.sort((a,b) => (b.dataset._ts|0) - (a.dataset._ts|0));

    // réinjection dans la grille dans le bon ordre
    cards.forEach(c => grid.appendChild(c));
  })();
</script>

</body>
</html>


</body>
</html>


